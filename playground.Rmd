---
title: "Playground"
output: html_document
---

# Load packages

```{r}
library(dplyr)
library(tidyr)
library(forcats)

library(ggplot2)
library(fmsb)

library(FactoMineR)
library(factoextra)
library(foreign)

library(stats)
library(clustMixType)
library(klaR)
```


# Load data

```{r}
survey <- read.csv("kaggle_survey_2020_responses.csv")[-1, -1]

for (i in 1:(dim(survey)[2]) ) {
  survey[,i] <- as.factor(survey[,i])
}
```


# Input

Targeted for students or data beginners

* Q1: What is your age (#years)?
* Q2: What is your gender?
* Q3: In which country do you currently reside?
* Q4: What is the highest level of formal education that you have attained or plan to attain within the next 2 years?
* Q6: For how many years have you been writing code and/or programming?
* Q15: For how many years have you used machine learning methods?

```{r}
input_data <- survey %>%
  dplyr::select(Q1, Q2, Q3, Q4, Q6, Q15)
```


## Run MCA


```{r}
mca <- MCA(input_data, ncp = 2, graph = FALSE)

fviz_mca_var(mca, choice = "mca.cor", 
            repel = TRUE, # Avoid text overlapping (slow)
            ggtheme = theme_minimal())
```


## Run K-means clustering

```{r}
set.seed(2020)

kmeans <- kmeans(mca$ind$coord, centers = 3, nstart = 20)
cluster <- as.factor(kmeans$cluster)

input_cluster <- cbind(input_data, mca$ind$coord, cluster)

ggplot(input_cluster, aes(`Dim 1`, `Dim 2`, color = cluster)) + geom_point()
```


## Analyze clusters

```{r, message=FALSE}
get_mode <- function(v) {
  # Remove empty value
  v <- as.data.frame(v)
  v <- as.factor(v[v != ""])
  uniqv <- unique(v)
  uniqv[which.max(tabulate(match(v, uniqv)))]
}

input_cluster %>%
  group_by(cluster) %>%
  summarize(age = get_mode(Q1),
            country = get_mode(Q3),
            degree = get_mode(Q4),
            yrs_of_coding = get_mode(Q6),
            yrs_of_ml = get_mode(Q15))


input_cluster %>%
  group_by(cluster) %>%
  summarize(count = n())
```


# Output

## Insights about jobs, salaries, companies

* Q5: Select the title most similar to your current role (or most recent title if retired)

```{r, warning=FALSE, message=FALSE}
q5 <- survey %>% dplyr::select(Q5)

q5_cluster <- cbind(q5, cluster)

q5_cluster <- q5_cluster %>%
  group_by(cluster, Q5) %>%
  summarize(count = n())

# Remove rows with empty string
q5_cluster <- q5_cluster[!apply(q5_cluster, 1, function(x) any(x == "")),] 

# Turn data into wide format
q5_cluster <- q5_cluster %>% pivot_wider(id_cols = cluster, names_from = Q5, values_from = count)
q5_cluster <- q5_cluster[, -1]

# Filter each cluster
q5_cluster_1 <- q5_cluster[1,]
q5_cluster_2 <- q5_cluster[2,]
q5_cluster_3 <- q5_cluster[3,]

# Plot radar chart
q5_cluster_1 <- rbind(rep(max(q5_cluster_1),13), rep(0,13), q5_cluster_1)
radarchart(q5_cluster_1, title = "Cluster 1")

q5_cluster_2 <- rbind(rep(max(q5_cluster_2),13), rep(0,13), q5_cluster_2)
radarchart(q5_cluster_2, title = "Cluster 2")

q5_cluster_3 <- rbind(rep(max(q5_cluster_3),13), rep(0,13), q5_cluster_3)
radarchart(q5_cluster_3, title = "Cluster 3")
```


* Q20: What is the size of the company where you are employed?

```{r, warning=FALSE, message=FALSE}
q20 <- survey %>% dplyr::select(Q20)

q20_cluster <- cbind(q20, cluster)

q20_cluster <- q20_cluster %>%
  group_by(cluster, Q20) %>%
  summarize(count = n())

# Remove rows with empty string
q20_cluster <- q20_cluster[!apply(q20_cluster, 1, function(x) any(x == "")),] 

# Turn data into wide format
q20_cluster <- q20_cluster %>% pivot_wider(id_cols = cluster, names_from = Q20, values_from = count)
q20_cluster <- q20_cluster[, -1]

# Filter each cluster
q20_cluster_1 <- q20_cluster[1,]
q20_cluster_2 <- q20_cluster[2,]
q20_cluster_3 <- q20_cluster[3,]

# Plot radar chart
q20_cluster_1 <- rbind(rep(max(q20_cluster_1),5), rep(0,5), q20_cluster_1)
radarchart(q20_cluster_1, title = "Cluster 1")

q20_cluster_2 <- rbind(rep(max(q20_cluster_2),5), rep(0,5), q20_cluster_2)
radarchart(q20_cluster_2, title = "Cluster 2")

q20_cluster_3 <- rbind(rep(max(q20_cluster_3),5), rep(0,5), q20_cluster_3)
radarchart(q20_cluster_3, title = "Cluster 3")
```


* Q21: Approximately how many individuals are responsible for data science workloads at your place at business?

```{r, warning=FALSE, message=FALSE}
q21 <- survey %>% dplyr::select(Q21)

q21_cluster <- cbind(q21, cluster)

q21_cluster <- q21_cluster %>%
  group_by(cluster, Q21) %>%
  summarize(count = n())

# Remove rows with empty string
q21_cluster <- q21_cluster[!apply(q21_cluster, 1, function(x) any(x == "")),] 

# Turn data into wide format
q21_cluster <- q21_cluster %>% pivot_wider(id_cols = cluster, names_from = Q21, values_from = count)
q21_cluster <- q21_cluster[, -1]

# Filter each cluster
q21_cluster_1 <- q21_cluster[1,]
q21_cluster_2 <- q21_cluster[2,]
q21_cluster_3 <- q21_cluster[3,]

# Plot radar chart
q21_cluster_1 <- rbind(rep(max(q21_cluster_1),7), rep(0,7), q21_cluster_1)
radarchart(q21_cluster_1, title = "Cluster 1")

q21_cluster_2 <- rbind(rep(max(q21_cluster_2),7), rep(0,7), q21_cluster_2)
radarchart(q21_cluster_2, title = "Cluster 2")

q21_cluster_3 <- rbind(rep(max(q21_cluster_3),7), rep(0,7), q21_cluster_3)
radarchart(q21_cluster_3, title = "Cluster 3")
```


* Q22: Does your current employer incorporate machine learning methods into their business?

```{r, warning=FALSE, message=FALSE}
q22 <- survey %>% dplyr::select(Q22)

q22_cluster <- cbind(q22, cluster)

q22_cluster <- q22_cluster %>%
  group_by(cluster, Q22) %>%
  summarize(count = n())

# Remove rows with empty string
q22_cluster <- q22_cluster[!apply(q22_cluster, 1, function(x) any(x == "")),] 

# Turn data into wide format
q22_cluster <- q22_cluster %>% pivot_wider(id_cols = cluster, names_from = Q22, values_from = count)
q22_cluster <- q22_cluster[, -1]

# Filter each cluster
q22_cluster_1 <- q22_cluster[1,]
q22_cluster_2 <- q22_cluster[2,]
q22_cluster_3 <- q22_cluster[3,]

# Plot radar chart
q22_cluster_1 <- rbind(rep(max(q22_cluster_1),6), rep(0,6), q22_cluster_1)
radarchart(q22_cluster_1, title = "Cluster 1")

q22_cluster_2 <- rbind(rep(max(q22_cluster_2),6), rep(0,6), q22_cluster_2)
radarchart(q22_cluster_2, title = "Cluster 2")

q22_cluster_3 <- rbind(rep(max(q22_cluster_3),6), rep(0,6), q22_cluster_3)
radarchart(q22_cluster_3, title = "Cluster 3")
```


* Q23: Select any activities that make up an important part of your role at work

```{r, warning=FALSE, message=FALSE}
q23 <- survey %>%
  dplyr::select(Q23_Part_1, Q23_Part_2, Q23_Part_3, Q23_Part_4, Q23_Part_5, Q23_Part_6, Q23_Part_7, Q23_OTHER)

q23_cluster <- cbind(q23, cluster)

q23_cluster <- q23_cluster %>%
  group_by(cluster) %>%
  summarize(`Analyze and understand data to influence product or business decisions` = sum(Q23_Part_1 != ""),
            `Build and/or run the data infrastructure that my business uses for storing, analyzing, and operationalizing data` = sum(Q23_Part_2 != ""),
            `Build prototypes to explore applying machine learning to new areas` = sum(Q23_Part_3 != ""),
            `Build and/or run a machine learning service that operationally improves my product or workflows` = sum(Q23_Part_4 != ""),
            `Experimentation and iteration to improve existing ML models` = sum(Q23_Part_5 != ""),
            `Do research that advances the state of the art of machine learning` = sum(Q23_Part_6 != ""),
            `None of these activities are an important part of my role at work` = sum(Q23_Part_7 != ""),
            `Other` = sum(Q23_OTHER != ""))

rownames(q23_cluster) <- q23_cluster$cluster
q23_cluster <- q23_cluster[, -c(1, 1)]


q23_cluster_1 <- q23_cluster[1,]
q23_cluster_2 <- q23_cluster[2,]
q23_cluster_3 <- q23_cluster[3,]

q23_cluster_1 <- rbind(rep(max(q23_cluster_1),8), rep(0,8), q23_cluster_1)
radarchart(q23_cluster_1, title = "Cluster 1")

q23_cluster_2 <- rbind(rep(max(q23_cluster_2),8), rep(0,8), q23_cluster_2)
radarchart(q23_cluster_2, title = "Cluster 2")

q23_cluster_3 <- rbind(rep(max(q23_cluster_3),8), rep(0,8), q23_cluster_3)
radarchart(q23_cluster_3, title = "Cluster 3")
```


* Q24: What is your current yearly compensation (approximate $USD)?


```{r, warning=FALSE, message=FALSE}
q24 <- survey %>% 
  mutate(Q24_Level = ifelse(Q24 %in% c(""), "", ifelse(Q24 %in% c("$0-999", "1,000-1,999", "2,000-2,999", "3,000-3,999", "4,000-4,999", "5,000-7,499", "7,500-9,999", "10,000-14,999", "15,000-19,999", "20,000-24,999", "25,000-29,999", "30,000-39,999", "40,000-49,999"), "Level 1 ($0-49,999)", ifelse(Q24 %in% c("50,000-59,999", "60,000-69,999", "70,000-79,999", "80,000-89,999", "90,000-99,999"), "Level 2 ($50,000-99,999)", ifelse(Q24 %in% c("100,000-124,999", "125,000-149,999"), "Level 3 ($100,000-149,999)", ifelse(Q24 %in% c("150,000-199,999"), "Level 4 ($150,000-199,999)", ifelse(Q24 %in% c("200,000-249,999", "250,000-299,999"), "Level 5 ($200,000-299,999)", ifelse(Q24 %in% c("300,000-500,000"), "Level 6 ($300,000-500,000)", "Level  7 (> $500,000)")))))))) %>%
  dplyr::select(Q24, Q24_Level)

q24_cluster <- cbind(q24, cluster)

q24_cluster <- q24_cluster %>%
  group_by(cluster, Q24_Level) %>%
  summarize(count = n())

# Remove rows with empty string
q24_cluster <- q24_cluster[!apply(q24_cluster, 1, function(x) any(x == "")),] 

# Turn data into wide format
q24_cluster <- q24_cluster %>% pivot_wider(id_cols = cluster, names_from = Q24_Level, values_from = count)
q24_cluster <- q24_cluster[, -1]

# Filter each cluster
q24_cluster_1 <- q24_cluster[1,]
q24_cluster_2 <- q24_cluster[2,]
q24_cluster_3 <- q24_cluster[3,]

# Plot radar chart
q24_cluster_1 <- rbind(rep(max(q24_cluster_1),7), rep(0,7), q24_cluster_1)
radarchart(q24_cluster_1, title = "Cluster 1")

q24_cluster_2 <- rbind(rep(max(q24_cluster_2),7), rep(0,7), q24_cluster_2)
radarchart(q24_cluster_2, title = "Cluster 2")

q24_cluster_3 <- rbind(rep(max(q24_cluster_3),7), rep(0,7), q24_cluster_3)
radarchart(q24_cluster_3, title = "Cluster 3")
```



## Insights about technical skills

* Q7: What programming languages do you use on a regular basis?

```{r}
q7 <- survey %>%
  dplyr::select(Q7_Part_1, Q7_Part_2, Q7_Part_3, Q7_Part_4, Q7_Part_5, Q7_Part_6, Q7_Part_7, Q7_Part_8, Q7_Part_9, Q7_Part_10, Q7_Part_11, Q7_Part_12, Q7_OTHER)

q7_cluster <- cbind(q7, cluster)

q7_cluster <- q7_cluster %>%
  group_by(cluster) %>%
  summarize(`Python` = sum(Q7_Part_1 != ""),
            `R` = sum(Q7_Part_2 != ""),
            `SQL` = sum(Q7_Part_3 != ""),
            `C` = sum(Q7_Part_4 != ""),
            `C++` = sum(Q7_Part_5 != ""),
            `Java` = sum(Q7_Part_6 != ""),
            `Javascript` = sum(Q7_Part_7 != ""),
            `Julia` = sum(Q7_Part_8 != ""),
            `Swift` = sum(Q7_Part_9 != ""),
            `Bash` = sum(Q7_Part_10 != ""),
            `MATLAB` = sum(Q7_Part_11 != ""),
            `None` = sum(Q7_Part_12 != ""),
            `Other` = sum(Q7_OTHER != ""))

rownames(q7_cluster) <- q7_cluster$cluster
q7_cluster <- q7_cluster[, -c(1, 1)]

# q7_cluster <- rbind(apply(q7_cluster, 2, max), apply(q7_cluster, 2, min), q7_cluster)

q7_cluster_1 <- q7_cluster[1,]
q7_cluster_2 <- q7_cluster[2,]
q7_cluster_3 <- q7_cluster[3,]

q7_cluster_1 <- rbind(rep(max(q7_cluster_1),13), rep(0,13), q7_cluster_1)
radarchart(q7_cluster_1, title = "Cluster 1")

q7_cluster_2 <- rbind(rep(max(q7_cluster_2),13), rep(0,13), q7_cluster_2)
radarchart(q7_cluster_2, title = "Cluster 2")

q7_cluster_3 <- rbind(rep(max(q7_cluster_3),13), rep(0,13), q7_cluster_3)
radarchart(q7_cluster_3, title = "Cluster 3")
```


* Q8: What programming language would you recommend an aspiring data scientist to learn first?




* Q9: Which of the following integrated development environments (IDE's) do you use on a regular basis?

```{r, warning=FALSE, message=FALSE}
q9 <- survey %>%
  dplyr::select(Q9_Part_1, Q9_Part_2, Q9_Part_3, Q9_Part_4, Q9_Part_5, Q9_Part_6, Q9_Part_7, Q9_Part_8, Q9_Part_9, Q9_Part_10, Q9_Part_11, Q9_OTHER)

q9_cluster <- cbind(q9, cluster)

q9_cluster <- q9_cluster %>%
  group_by(cluster) %>%
  summarize(`Jupyter` = sum(Q9_Part_1 != ""),
            `RStudio` = sum(Q9_Part_2 != ""),
            `Visual Studio` = sum(Q9_Part_3 != ""),
            `Visual Studio Code` = sum(Q9_Part_4 != ""),
            `Pycharm` = sum(Q9_Part_5 != ""),
            `Spyder` = sum(Q9_Part_6 != ""),
            `Notepad++` = sum(Q9_Part_7 != ""),
            `Sublime Text` = sum(Q9_Part_8 != ""),
            `Vim/Emacs`= sum(Q9_Part_9 != ""),
            `MATLAB` = sum(Q9_Part_10 != ""),
            `None` = sum(Q9_Part_11 != ""),
            `Other` = sum(Q9_OTHER != ""))

rownames(q9_cluster) <- q9_cluster$cluster
q9_cluster <- q9_cluster[, -1]

q9_cluster_1 <- q9_cluster[1,]
q9_cluster_2 <- q9_cluster[2,]
q9_cluster_3 <- q9_cluster[3,]

q9_cluster_1 <- rbind(rep(max(q9_cluster_1),12), rep(0,12), q9_cluster_1)
radarchart(q9_cluster_1, title = "Cluster 1")

q9_cluster_2 <- rbind(rep(max(q9_cluster_2),12), rep(0,12), q9_cluster_2)
radarchart(q9_cluster_2, title = "Cluster 2")

q9_cluster_3 <- rbind(rep(max(q9_cluster_3),12), rep(0,12), q9_cluster_3)
radarchart(q9_cluster_3, title = "Cluster 3")
```


* Q31-A: Which of the following business intelligence tools do you use on a regular basis? (Select all that apply)

```{r}
q31 <- survey %>%
  dplyr::select(Q31_A_Part_1, Q31_A_Part_2, Q31_A_Part_3, Q31_A_Part_4, Q31_A_Part_5, Q31_A_Part_6, Q31_A_Part_7, Q31_A_Part_8, Q31_A_Part_9, Q31_A_Part_10, Q31_A_Part_11, Q31_A_Part_12, Q31_A_Part_13, Q31_A_Part_14, Q31_A_OTHER)

q31_cluster <- cbind(q31, cluster)

q31_cluster <- q31_cluster %>%
  group_by(cluster) %>%
  summarize(`Amazon QuickSight` = sum(Q31_A_Part_1 != ""),
            `Microsoft Power BI` = sum(Q31_A_Part_2 != ""),
            `Google Data Studio` = sum(Q31_A_Part_3 != ""),
            `Looker` = sum(Q31_A_Part_4 != ""),
            `Tableau` = sum(Q31_A_Part_5 != ""),
            `Salesforce` = sum(Q31_A_Part_6 != ""),
            `Einstein Analytics` = sum(Q31_A_Part_7 != ""),
            `Qlik` = sum(Q31_A_Part_8 != ""),
            `Domo` = sum(Q31_A_Part_9 != ""),
            `TIBCO Spotfire` = sum(Q31_A_Part_10 != ""),
            `Alteryx` = sum(Q31_A_Part_11 != ""),
            `Sisense` = sum(Q31_A_Part_12 != ""),
            `SAP` = sum(Q31_A_Part_13 != ""),
            `None` = sum(Q31_A_Part_14 != ""),
            `Other` = sum(Q31_A_OTHER != ""))

rownames(q31_cluster) <- q31_cluster$cluster
q31_cluster <- q31_cluster[, -1]

# q31_cluster <- rbind(apply(q31_cluster, 2, max), apply(q31_cluster, 2, min), q31_cluster)

q31_cluster_1 <- q31_cluster[1,]
q31_cluster_2 <- q31_cluster[2,]
q31_cluster_3 <- q31_cluster[3,]

q31_cluster_1 <- rbind(rep(max(q31_cluster_1),15), rep(0,15), q31_cluster_1)
radarchart(q31_cluster_1, title = "Cluster 1")

q31_cluster_2 <- rbind(rep(max(q31_cluster_2),15), rep(0,15), q31_cluster_2)
radarchart(q31_cluster_2, title = "Cluster 2")

q31_cluster_3 <- rbind(rep(max(q31_cluster_3),15), rep(0,15), q31_cluster_3)
radarchart(q31_cluster_3, title = "Cluster 3")
```


* Q36: Where do you publicly share or deploy your data analysis or machine learning applications?

```{r, warning=FALSE, message=FALSE}
q36 <- survey %>%
  dplyr::select(Q36_Part_1, Q36_Part_2, Q36_Part_3, Q36_Part_4, Q36_Part_5, Q36_Part_6, Q36_Part_7, Q36_Part_8, Q36_Part_9, Q36_OTHER)

q36_cluster <- cbind(q36, cluster)

q36_cluster <- q36_cluster %>%
  group_by(cluster) %>%
  summarize(`Plotly Dash` = sum(Q36_Part_1 != ""),
            `Streamlit` = sum(Q36_Part_2 != ""),
            `NBViewer` = sum(Q36_Part_3 != ""),
            `GitHub` = sum(Q36_Part_4 != ""),
            `Personal blog` = sum(Q36_Part_5 != ""),
            `Kaggle` = sum(Q36_Part_6 != ""),
            `Colab` = sum(Q36_Part_7 != ""),
            `Shiny` = sum(Q36_Part_8 != ""),
            `I do not share my work publicly` = sum(Q36_Part_9 != ""),
            `Other` = sum(Q36_OTHER != ""))

rownames(q36_cluster) <- q36_cluster$cluster
q36_cluster <- q36_cluster[, -1]


q36_cluster_1 <- q36_cluster[1,]
q36_cluster_2 <- q36_cluster[2,]
q36_cluster_3 <- q36_cluster[3,]

q36_cluster_1 <- rbind(rep(max(q36_cluster_1),10), rep(0,10), q36_cluster_1)
radarchart(q36_cluster_1, title = "Cluster 1")

q36_cluster_2 <- rbind(rep(max(q36_cluster_2),10), rep(0,10), q36_cluster_2)
radarchart(q36_cluster_2, title = "Cluster 2")

q36_cluster_3 <- rbind(rep(max(q36_cluster_3),10), rep(0,10), q36_cluster_3)
radarchart(q36_cluster_3, title = "Cluster 3")
```

